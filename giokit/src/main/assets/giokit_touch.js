var e,t,n=function(){return n=Object.assign||function(e){for(var t,n=1,i=arguments.length;i>n;n++)for(var r in t=arguments[n])({}).hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)};function i(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;o>r;r++)!i&&r in t||(i||(i=[].slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||[].slice.call(t))}function r(e){return e&&e.__esModule&&{}.hasOwnProperty.call(e,"default")?e.default:e}"function"==typeof SuppressedError&&SuppressedError;var o,a,u,s,c,l="function"==typeof Array.from?Array.from:(t||(t=1,o=function(e){return"function"==typeof e},a=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),9007199254740991)},u=function(e){var t=e.next();return!t.done&&t},e=function(e){var t,n,i,r=this,s=arguments.length>1?arguments[1]:void 0;if(void 0!==s){if(!o(s))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(t=arguments[2])}var c=function(e,t){if(null!=e&&null!=t){var n=e[t];if(null==n)return;if(!o(n))throw new TypeError(n+" is not a function");return n}}(e,function(e){if(null!=e){if(["string","number","boolean","symbol"].indexOf(typeof e)>-1)return Symbol.iterator;if("undefined"!=typeof Symbol&&"iterator"in Symbol&&Symbol.iterator in e)return Symbol.iterator;if("@@iterator"in e)return"@@iterator"}}(e));if(void 0!==c){n=o(r)?Object(new r):[];var l,d,f=c.call(e);if(null==f)throw new TypeError("Array.from requires an array-like or iterable object");for(i=0;;){if(!(l=u(f)))return n.length=i,n;d=l.value,n[i]=s?s.call(t,d,i):d,i++}}else{var h=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var g,v=a(h.length);for(n=o(r)?Object(new r(v)):Array(v),i=0;v>i;)g=h[i],n[i]=s?s.call(t,g,i):g,i++;n.length=v}return n}),e),d=function(e){try{return e()}catch(e){return}},f=function(e){return"number"===y(e)},h=function(e){return"object"===y(e)&&!function(e){return p(["undefined","null"],y(e))}(e)},g=function(e){return Array.isArray(e)&&"array"===y(e)},v=function(e,t){var n=-1;if(g(e))for(var i=0;i<e.length;i++)if(t(e[i]))return i;return n},p=function(e,t){return("array"===y(e)||"string"===y(e))&&e.indexOf(t)>=0},m=r(l),w=function(e){return g(e)?0===e.length:h(e)?0===function(e){return h(e)?Object.keys(e):[]}(e).length:!e},N=function(e){if(g(e)){for(var t=0,n=[],i=0,r=e;i<r.length;i++){var o=r[i];o&&!w(o)&&(n[t++]=o)}return n}return e},y=function(e){return{}.toString.call(e).slice(8,-1).toLowerCase()},b=["body","br","canvas","clippath","defs","desc","g","hr","html","iframe","math","param","path","rect","script","style","text","title","tspan","use"],L=["button","reset","submit"],E=i(i([],L,!0),["file"],!1),x=["checkbox","color","radio","range"],k=i(i([],x,!0),["date","datetime-local","month","number","password","text","time","week"],!1),T=["tr","li","dt","dd"],_=i(["a","button","dl"],T,!0),I=["i","em","svg","img"],C=["i","span","em","b","strong","bdo"],O=/(^| |[^ ]+\-)(clear|clearfix|active|hover|enabled|current|selected|unselected|hidden|display|focus|disabled|undisabled|open|checked|unchecked|undefined|null|ng-|growing-)[^\. ]*/g,S=/^([a-zA-Z\-\_0-9]+)$/,P="data-growing-ignore",A="data-growing-container",B="data-growing-index",D="data-growing-title",H=function(e,t){console.log("%c [GrowingIO]：".concat(e),{info:"color: #3B82F6;",error:"color: #EF4444;",warn:"color: #F59E0B;",success:"color: #10B981;"}[t]||"")},G=function(e,t){var n;return null!==(n=d((function(){return e.hasAttribute(t)&&"false"!==e.getAttribute(t)})))&&void 0!==n?n:d((function(){return e.hasOwnPerporty(t)}))},X=function(e,t){var n;return null!==(n=d((function(){return e.getAttribute(t)})))&&void 0!==n?n:d((function(){return e.attributes[t].value}))},j=function(e){var t,n=!p(b,e.tagName.toLowerCase()),i=J(e);return n&&i&&p(C,null===(t=e.tagName)||void 0===t?void 0:t.toLowerCase())?j(i):e},z=function(e,t,n){if(void 0===t&&(t=5),void 0===n&&(n=0),!e.children)return!1;if("svg"===e.tagName.toLocaleLowerCase())return n>t;if(n>t)return!0;for(var i=0;i<e.children.length;i++){var r=e.children[i];if(z(r,t,n+1))return!0}return!1},M=function(e,t){var n=e.tagName.toLowerCase();if(!(e instanceof Element))return!1;if(G(e,P))return!1;if(p(b,n))return!1;if(p(["circleClick","circleHover","click"],t)){if("textarea"===n&&"click"===t)return!1;if("input"===n){if("click"===t&&!p(E,X(e,"type")))return!1;if(p(["circleClick","circleHover"],t)&&!p(i(i([],E,!0),k,!0),X(e,"type")))return!1}if(!R(e)&&z(e,5))return!1}return!0},W=function(e,t){return void 0===t&&(t=!1),m((null==e?void 0:e.childNodes)||[]).filter((function(e){return p(t?[Node.ELEMENT_NODE,Node.TEXT_NODE]:[Node.ELEMENT_NODE],e.nodeType)}))},J=function(e){return F(e.parentElement)?null:e.parentElement},F=function(e){return!e||p(["BODY","HTML","#document"],e.tagName)},R=function(e){return G(e,A)||p(_,e.tagName.toLowerCase())||"input"===e.tagName.toLowerCase()&&p(L,e.type)},Z=function(e){var t=W(e);return!w(t)&&t.every((function(e){var t=Y(e),n=p(e.classList,"icon");return!(!t&&!n||U(e))}))},U=function(e){var t=W(e,!0);return!w(t)&&t.every((function(e){var t=e.nodeType===Node.TEXT_NODE,n=q(e);return!(!t||!n)}))},Y=function(e){return p(I,e.tagName.toLocaleLowerCase())},q=function(e){var t=W(e,!0).filter((function(e){var t;return e.nodeType===Node.TEXT_NODE||p(C,null===(t=e.tagName)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return V(e.textContent,e.textContent.length)}));return N(t).join(" ")},V=function(e,t){return void 0===t&&(t=50),e&&(null==(e=e.replace(/[\n \t]+/g," ").trim())?void 0:e.length)?e.slice(0,f(t)&&t>0?t:void 0):""},$=/[^/]*.(bmp|jpg|jpeg|png|gif|svg|psd|webp|apng)/gi,K=function(e,t){switch(t){case"a":return function(e){if(G(e,"href")){var t=X(e,"href");if(t&&0!==t.indexOf("javascript"))return t.slice(0,320)}return""}(e);case"img":return function(e){var t=e.src;if(t&&-1===t.indexOf("data:image")){var n=t.match($),i=w(n)?"":n[0];if(i.indexOf("%")>-1){var r=function(e,t){var n=-1;if(g(e))for(var i=0;i<e.length;i++)"%"===e[i]&&(n=i);return n}(i.split(""));i=i.substring(r+3,i.length)}return i}return""}(e);default:return""}},Q={a:function(e){var t=q(e);return t||(ne(e)||K(e,"a"))},button:function(e){var t=X(e,"name");if(t)return t;var n=q(e);return n||(ne(e)||ie(e))},img:function(e){return V(X(e,"alt"))||K(e,"img")},input:function(e){if("password"===e.type)return"";var t,n,i=e instanceof HTMLInputElement&&p(E,e.type),r=G(e,"data-growing-track");if(i||r)return V(e.value);if(e instanceof HTMLInputElement&&p(x,e.type)){var o=void 0;if(e.id)n=function(t){return t.htmlFor===e.id},o=(t=m(document.getElementsByTagName("label")))[v(t,n)];else o=te(e,(function(e){return"label"===e.tagName.toLowerCase()}));return re(e,o?q(o):V(e.value))}return""},label:function(e){var t=q(e);return t||(ne(e)||ie(e))},select:function(e){return V(m(e.options).filter((function(e){return e.selected})).map((function(e){return e.label})).join(", ")||e.value)},svg:function(e){var t;return W(e).some((function(e){var n;if(e.nodeType===Node.ELEMENT_NODE&&"use"===(null===(n=e.tagName)||void 0===n?void 0:n.toLowerCase())&&e.hasAttribute("xlink:href"))return t=e,!0})),t?t.getAttribute("xlink:href"):""},textarea:function(){return""},form:function(){return""}},ee=function(e,t){if(G(e,D)&&X(e,D))return V(X(e,D));if(G(e,"title")&&X(e,"title"))return V(X(e,"title"));var n=Q[t];if(n)return n(e);var i=q(e);return i?V(i):function(e){if("svg"===e.tagName)return!1;var t=W(e);return t.length>0&&t.every((function(e){return function(e){if("svg"===e.tagName)return!0;var t=W(e);if(w(t))return!0;var n=U(e);return!(!w(t)&&!n)}(e)}))}(e)&&!Z(e)?V(ne(e)):Z(e)?V(ie(e)):""},te=function(e,t){for(var n=e.parentElement;n&&!F(n);){if(t(n))return n;n=n.parentElement}},ne=function(e){var t=W(e);return N(t.map((function(e){var t=q(e);if(U(e)&&t)return t}))).join(" ")},ie=function(e){var t;return W(e).some((function(e){var n,i=ee(e,null===(n=e.tagName)||void 0===n?void 0:n.toLowerCase());return!!i&&(t=i,!0)})),t},re=function(e,t){return p(["checkbox","radio"],e.type)?"".concat(t).concat((n=e.checked,"boolean"===y(n)?"("+e.checked+")":"")):t;var n},oe=function e(t,n,r,o,a){void 0===o&&(o=!0),void 0===a&&(a=[]);var u=this;this.originNode=t,this.deviceInfo=n,this.actionType=r,this.trackable=o,this.parentNodes=a,this._getIndex=function(){if(G(u.originNode,B)){var e=X(u.originNode,B);return/^\d{1,10}$/.test(e)&&e-0>0&&2147483647>e-0?+e:void(0>u.actionType.indexOf("circle")&&H("".concat(e,"，index标记应为 大于 0 且小于 2147483647 的整数！"),"warn"))}if(p(["dd","dt"],u.tagName)){var t=J(u.originNode),n=t?W(t):[];if("dl"===t.tagName.toLowerCase()&&n.length>0){if("dd"===u.tagName){var r=v(n,(function(e){return e.isSameNode(u.originNode)}));if(r>-1)return(o=n.slice(0,r).filter((function(e){return"dt"===e.tagName.toLowerCase()}))).length-1+1}if("dt"===u.tagName){var o=n.filter((function(e){return"dt"===e.tagName.toLowerCase()}));return v(o,(function(e){return e.isSameNode(u.originNode)}))+1}}}if(u.isPureList){var a=v(u._pureList,(function(e){return e.isSameNode(u.originNode)}));return a>-1?(u.peerNodes=i([],u._pureList,!0),u.peerNodes.splice(a,1),a+1):void 0}if(u.isPseudoList){var s=v(u._pseudoList,(function(e){return e.isSameNode(u.originNode)}));return s>-1?(u.peerNodes=i([],u._pseudoList,!0),u.peerNodes.splice(s,1),s+1):void 0}},this._getSiblingNode=function(e,t){var n,i=J(e);if(!i)return[];for(var r=null!==(n=d((function(){return m(i.children)})))&&void 0!==n?n:[],o=[],a=0;a<r.length;a++){var u=r[a],s=r[a+1];if(!s||!t(u,s))break;w(o)?o.push(u,s):o.push(s)}return o},this._getIsPureList=function(){var e=u._getSiblingNode(u.originNode,(function(e,t){return e.tagName===t.tagName}));return!(1>e.length||!p(T,u.tagName)||(u._pureList=e,0))},this._getIsInPseudoList=function(){if(p(["th","td"],u.tagName))return!1;var e=u._getSiblingNode(u.originNode,(function(e,t){var n=e.tagName===t.tagName&&e.className===t.className,i=W(e),r=W(t),o=i.every((function(e,t){var n,i;return(null==e?void 0:e.tagName)===(null===(n=r[t])||void 0===n?void 0:n.tagName)&&(null==e?void 0:e.className)===(null===(i=r[t])||void 0===i?void 0:i.className)})),a=i.length===r.length&&o;return n&&a}));return e.length>=3&&(u._pseudoList=e,!0)},this._getClassList=function(e){var t;if(G(e,"name")&&X(e,"name"))return[X(e,"name")];var n=(null!==(t=X(e,"class"))&&void 0!==t?t:"").trim().split(" ");return w(n)?[]:n.filter((function(e){return e&&!O.test(e)&&S.test(e)})).sort()},this._getCurrentXpath=function(){return"/".concat(u.tagName).concat(u.id?"#"+u.id:"").concat(w(u.classList)?"":"."+u.classList.join("."))},this._getIsContainer=function(){return G(u.originNode,A)||p(_,u.tagName)||"input"===u.tagName&&p(L,u.originNode.type)},this._getContent=function(){u.content=ee(u.originNode,u.tagName)},this._getIsOutFlow=function(){var e=window.getComputedStyle(u.originNode).position;return p(["fixed","sticky"],e)},this._getRect=function(){var e=u.originNode.getBoundingClientRect(),t=e.top,n=e.bottom,i=e.left,r=e.right-i,o=n-t;return t+o>u.deviceInfo.winHeight&&(o=u.deviceInfo.winHeight-t),i+r>u.deviceInfo.winWidth&&(r=u.deviceInfo.winWidth-i),{top:t,left:i,width:r,height:o}},this._getViewStatus=function(){var e=window.getComputedStyle(u.originNode),t=e.opacity,n=e.visibility,i=e.display,r=e.width,o=e.height,a=u.rect,s=a.top,c=a.left,l=a.width,d=a.height,f=u.deviceInfo,h=f.winWidth,g=f.winHeight;if(0===Number(t)||"hidden"===n||"none"===i||"0px"===r||"0px"===o)return"HIDDEN";var v=function(e,t){return document.elementFromPoint(e,t)===u.originNode};return g>s&&h>c&&l>0&&d>0?v(c+l/2,s+d/2)||v(c+1,s+1)||v(c+l-1,s+1)||v(c+1,s+d-1)||v(c+l-1,s+d-1)?"DISPLAYED":0>s+d||0>c+l?"OUTSIDE":"OBSCURED":"OUTSIDE"},this._getTriggerEvent=function(){return"input"===u.tagName&&p(k,u.originNode.type)||p(["select","textarea"],u.tagName)?"VIEW_CHANGE":"VIEW_CLICK"},this._getXParents=function(t,n){var i=t.parentElement,r=[];if(n.length>0)r.push.apply(r,n);else for(;i&&!F(i);)r.push(new e(i,void 0,u.actionType,M(i,u.actionType))),i=i.parentElement;return r},this.tagName=t.tagName.toLocaleLowerCase(),this.classList=this._getClassList(t),this.id=t.id,this.currentXpath=this._getCurrentXpath(),this.isIgnored=G(this.originNode,P),this.isContainer=this._getIsContainer(),this.isPureList=this._getIsPureList(),this.isPseudoList=this._getIsInPseudoList(),this.index=this._getIndex(),this.hyperlink=K(t,this.tagName),this.content=ee(this.originNode,this.tagName),this.triggerEvent=this._getTriggerEvent(),this.isOutFlow=this._getIsOutFlow(),n&&(this.rect=this._getRect(),this.viewStatus=this._getViewStatus()),this.xParents=this._getXParents(t,a)},ae=function e(t,n,i,r,o){var a=this;this.origin=t,this.action=n,this.lengthThreshold=i,this.deviceInfo=r,this.parentNode=o,this.trackNodes=function(){var e;if(!a.trackable)return[];var t=[a.xNode];if(p(["click","circleClick","change"],a.actionType))for(var n=a._getParent();n;){if(!(null==n?void 0:n.xNode)||(null===(e=n.xNode)||void 0===e?void 0:e.isIgnored))return[];n.trackable&&t.push(n.xNode),n=n._getParent()}var i,r=[];return t.reverse().forEach((function(e,n){if(G(e.originNode,A)&&(r=[],i=void 0),f(e.index)&&!f(i)&&(i=e.index),f(i)&&(e.index=i),n===t.length-1)r.push(a.getGioNodeInfo(e));else{var o=e.isPureList||e.isPseudoList;(e.isContainer||o)&&r.push(a.getGioNodeInfo(e))}})),r},this.getGioNodeInfo=function(e){var t=a.computeXpath(e),n=t.skeleton,i=t.fullXpath,r=t.xpath,o=t.xcontent,u=e.hyperlink,s=e.index,c=e.peerNodes;return{skeleton:n,fullXpath:i,xpath:r,xcontent:o,hyperlink:u,index:s,peerNodes:null!=c?c:[],content:e.content,triggerEvent:e.triggerEvent,originNode:e.originNode}},this.computeXpath=function(e){var t,n="/"+e.tagName,i=e.currentXpath,r=e.currentXpath,o="/"+((e.id?"#"+e.id:"")+(w(e.classList)?"":"."+e.classList.join("."))||"-");return null===(t=e.xParents)||void 0===t||t.forEach((function(e,t){if(i=e.currentXpath+i,t<a.xpathThreshold-1){n="/"+e.tagName+n,r=e.currentXpath+r;var u=(e.id?"#"+e.id:"")+(w(e.classList)?"":"."+e.classList.join("."));o="/"+(u||"-")+o}})),{skeleton:n,fullXpath:i,xpath:r,xcontent:o}},this._getParent=function(){var t=J(a.originElement);if(t&&t.nodeName&&!F(t))return new e(t,a.actionType)},this.actionType=p(["circleClick","circleHover","click","change"],n)?n:"click",this.originElement=j(t),this.xpathThreshold=f(i)?i:4,this.trackable=M(this.originElement,this.actionType);var u=[];o&&o.xNode&&(u.push(o.xNode),o.xNode.xParents&&u.push.apply(u,o.xNode.xParents)),this.xNode=new oe(this.originElement,this.deviceInfo,this.actionType,this.trackable,u)},ue=[],se=function(e,t){var i,r,o,a,u,s,c,l=this;this.trackNodes=function(e,t){return ue=[],l._getTrackElements(e,t,null),ue},this._getTrackElements=function(e,t,n){W(e).forEach((function(e){var i,r,o,a,u;if(!(null==e?void 0:e.tagName)||"circle-shape"===(null===(i=null==e?void 0:e.tagName)||void 0===i?void 0:i.toLowerCase())||"heatmap-page"===(null===(r=null==e?void 0:e.tagName)||void 0===r?void 0:r.toLowerCase())||(null===(o=null==e?void 0:e.id)||void 0===o?void 0:o.indexOf("__vconsole"))>-1||(null===(a=null==e?void 0:e.id)||void 0===a?void 0:a.indexOf("__giokit"))>-1)return!1;var s=new ae(e,"circleClick",l.xpathThreshold,l.deviceInfo,n),c=s.xNode;if(c.zLevel=l._getZLevel(e,t),s.trackable&&p(["DISPLAYED","OBSCURED"],c.viewStatus)){if(t.index&&(c.index=t.index),"DISPLAYED"===c.viewStatus){var d=l._getGioHybridNodeInfo(s,t);ue.push(d)}else"OBSCURED"===c.viewStatus&&c.isContainer&&(d=l._getGioHybridNodeInfo(s,t),ue.push(d));if(Y(e)||c.isContainer&&U(e))return!1}w(W(e))||l._getTrackElements(e,null!==(u=s.xNode)&&void 0!==u?u:t,s)}))},this._getZLevel=function(e,t){var n=window.getComputedStyle(e),i=n.position,r=n.zIndex;if("auto"!==r)return Number(r||"0")+t.zLevel;switch(i){case"relative":return t.zLevel+2;case"sticky":return t.zLevel+3;case"absolute":return t.zLevel+4;case"fixed":return t.zLevel+5;default:return t.zLevel+1}},this._getGioHybridNodeInfo=function(e,t){var i=e.xNode,r=i.rect,o=i.zLevel,a=e.getGioNodeInfo(i),u=a.hyperlink;return n(n(n({},r),a),{zLevel:o+l.deviceInfo.webviewZLevel,href:u,parentXPath:t.trackable?e.computeXpath(t).xpath:void 0})},this.xpathThreshold=t,this.deviceInfo=(r=(i=e).webviewLeft,o=i.webviewTop,a=i.webviewWidth,u=i.webviewHeight,s=i.webviewZLevel,{winWidth:c=document.documentElement.clientWidth,winHeight:document.documentElement.clientHeight,scale:a/c,webviewTop:o,webviewLeft:r,webviewWidth:a,webviewHeight:u,webviewZLevel:s})},ce=function(){function e(){this.elements=[],this.scale=1,window.GiokitTouchJavascriptBridge?this.hasTouchBridge=!0:this.hasTouchBridge=!1,this.initGiokitTouchJavascriptBridge()}return e.prototype.initGiokitTouchJavascriptBridge=function(){var e=this;window.GiokitTouchJavascriptBridge&&(window.GiokitTouchJavascriptBridge.hoverOn=function(t,n,i){1===e.scale&&(e.scale=window.innerWidth/t),e.hoverOn(n*e.scale,i*e.scale)},window.GiokitTouchJavascriptBridge.highLightElementAtPoint=function(){e.elements=[],e.highLightElements([e.lastElement]),window.GiokitTouchJavascriptBridge.hoverNodes(JSON.stringify(e.lastElement))},window.GiokitTouchJavascriptBridge.cancelHover=function(){e.elements=[],e.hideMask()},this.hasTouchBridge=!0)},e.prototype.getDeviceInfo=function(){return{left:0,top:0,winWidth:window.innerWidth,winHeight:window.innerHeight,zLevel:0}},e.prototype.getAllNodes=function(){var e=new se(this.getDeviceInfo()),t=(new Date).getTime();this.elements=e.trackNodes(document.body,{isContainer:!1,zLevel:0});var n=(new Date).getTime();H("getAllNodes cost "+(n-t),"info")},e.prototype.highLightElements=function(e){document.body.querySelectorAll(".giokit_mask").forEach((function(e){e.remove()})),e.forEach((function(e){var t=document.createElement("div");t.attributes["data-growing-ignore"]="",t.className="giokit_mask",t.style.backgroundColor="rgba(252,95,58,0.1)",t.style.border="1px solid red";var n=e.top+window.scrollY,i=e.left+window.scrollX;t.style.zIndex="9999",t.style.left=i+"px",t.style.top=n+"px",t.style.width=e.width+"px",t.style.height=e.height+"px",t.style.position="absolute",t.style.pointerEvents="none",document.body.appendChild(t)}))},e.prototype.hoverOn=function(e,t){if(this.hasTouchBridge||(H("GiokitTouchJavascriptBridge is not exist!","info"),this.initGiokitTouchJavascriptBridge()),this.hasTouchBridge){0===this.elements.length&&this.getAllNodes();var n=this.elements.filter((function(n){return!(n.left>e||n.width+n.left<e||n.top>t||n.top+n.height<t)}));this.highLightElements(n),n.sort((function(e,t){return e.width*e.height-t.width*t.height}));var i=n[0];i&&(this.lastElement=i)}},e.prototype.hideMask=function(){document.body.querySelectorAll(".giokit_mask").forEach((function(e){e.remove()})),this.lastElement=null},e}(),le="giokitTouch";(null===(c=window[le])||void 0===c?void 0:c.giokitTouchInstalled)?(s=window[le],H("重复加载!","warn")):(H("GiokitTouch init","info"),s=new ce,window[le]=s,window.giokitTouch=s,window.giokitTouchInstalled=!0);
